[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "statistics dojo",
    "section": "",
    "text": "Welcome\nこのQuarto Bookは統計関係の基礎問題練習道場となります． 一部，Rでの可視化を実施しています．\n\n参考文献\n\n\n\n\n\n\n\n\n\n略称\nTitle\n著者\nISBN\n\n\n\n\n金川本\n確率そのまま使える答えの書き方\n金川 秀也 著\n9784061539624\n\n\n成田本\n例題で学べる確率モデル\n成田 清正 著\n9784320019126\n\n\nMHE\nMostly Harmless Econometrics: An Empiricist’s Companion. Princeton University Press, 2009\nAngrist, J. D., and J. S. Pischke\n9780691120355",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "posts/statistics101/probability_and_set.html",
    "href": "posts/statistics101/probability_and_set.html",
    "title": "1  集合演算と確率",
    "section": "",
    "text": "集合演算",
    "crumbs": [
      "確率基礎",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>集合演算と確率</span>"
    ]
  },
  {
    "objectID": "posts/statistics101/probability_and_set.html#集合演算",
    "href": "posts/statistics101/probability_and_set.html#集合演算",
    "title": "1  集合演算と確率",
    "section": "",
    "text": "Exercise 1.1 \n以下の事象を簡単に表せ：\n\\[\n\\begin{align}\n&(A \\cup B) \\cup (C \\cup B^c)\\tag{a}\\\\[4pt]\n&A \\cap (B \\backslash A)\\tag{b}\\\\[4pt]\n&(A\\cap B) \\cup (A \\backslash B)\\tag{c}\\\\[4pt]\n&(A\\cup B) \\cap (A \\cup B^c)\\tag{d}\\\\[4pt]\n&(A\\cup B) \\cap (A^c \\cup B) \\cap (A \\cup B^c)\\tag{e}\\\\[4pt]\n&A\\cup (B - (A\\cap B))\\cup (C - (A\\cap C))\\tag{f}\n\\end{align}\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n ▶  (a)\n結合法則より\n\\[\n\\begin{align*}\n(A\\cup C) \\cup (B \\cup B^c) = (A\\cup C) \\cup \\Omega = \\Omega\n\\end{align*}\n\\]\n ▶  (b)\n結合法則より\n\\[\n\\begin{align*}\nA \\cap (B \\cap A^c) = (A\\cap A^c) \\cap B = \\emptyset \\cap B = \\emptyset\n\\end{align*}\n\\]\n ▶  (c)\n分配法則より\n\\[\n\\begin{align*}\n(A\\cap B) \\cup (A \\cap B^c) = A \\cap (B \\cup B^c) = A\\cap \\Omega = A\n\\end{align*}\n\\]\n ▶  (d)\n分配法則より\n\\[\n(A\\cup B) \\cap (A \\cup B^c) = A \\cup (B\\cap B^c) = A\\cup \\emptyset = A\n\\]\n ▶  (e)\n結合法則と分配法則より\n\\[\n\\begin{align*}\n&(A\\cup B) \\cap (A^c \\cup B) \\cap (A \\cup B^c)\\\\\n&=((A\\cup B) \\cap (A^c \\cup B)) \\cap (A \\cup B^c)\\\\\n&= (B\\cup (A\\cap A^c))\\cap (A \\cup B^c)\\\\\n&= B\\cap (A \\cup B^c)\\\\\n&= (A\\cap B) \\cup (B\\cap B^c)\\\\\n&= (A\\cap B)\n\\end{align*}\n\\]\n ▶  (f)\n\\[\n\\begin{align*}\nB - (A\\cap B) &= B \\cap (A\\cap B)^c\\\\\n              &= (A^c \\cap B) \\cup (B \\cap B^c)\\\\\n              &= (A^c \\cap B)\n\\end{align*}\n\\]\nしたがって，\n\\[\n\\begin{align*}\n&A\\cup (B - (A\\cap B))\\cup (C - (A\\cap C))\\\\\n&= A\\cup (A^c \\cap B) \\cup ((A^c \\cap C))\\\\\n&= A\\cup (A^c \\cap B) \\cup ((A^c \\cap C)) \\cup A\\\\\n&= (\\Omega \\cap (A\\cup B)) \\cup (\\Omega \\cap (A\\cup C))\\\\\n&= (A\\cup B) \\cup ((A\\cup C))\\\\\n&= A\\cup B \\cup C\n\\end{align*}\n\\]\n\n\n\n\n\nExercise 1.2 \nA, Bが事象のとき, \\[\nA\\cup B = (A\\cap B) \\cup (A\\cap B^c) \\cup (A^c \\cap B) \\tag{a}\n\\]\nであることを確かめよ．または，\\(A\\cap B, A\\cap B^c , A^c \\cap B\\) は互いに排反であることを調べよ．\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n ▶  (a)の成立について \n\\[\n\\begin{align*}\nA &= A\\cap \\Omega\\\\\n  &= A\\cap (B\\cup B^c)\\\\\n  &= (A\\cap B) \\cup (A\\cap B^c)\n\\end{align*}\n\\]\n同様に，\\(B = (A\\cap B) \\cup (A^c\\cap B)\\) . 従って，\n\\[\n\\begin{align*}\nA \\cup B &= ((A\\cap B) \\cup (A^c\\cap B)) \\cup (A\\cap B) \\cup (A\\cap B^c)\\\\\n         &= (A\\cap B) \\cup (A^c\\cap B) \\cup (A\\cap B^c)\n\\end{align*}\n\\]\n ▶  各事象の排反性について\n\\[\n\\begin{align*}\n(A\\cap B) &\\subset B\\\\\n(A\\cap B^c) &\\subset B^c\n\\end{align*}\n\\]\nより，\\((A\\cap B) \\cap (A\\cap B^c) = \\emptyset\\). 同様に\n\\[\n\\begin{align*}\n(A\\cap B) &\\subset A\\\\\n(A^c\\cap B) &\\subset A^c\\\\\n(A\\cap B^c) &\\subset A\n\\end{align*}\n\\]\n従って，\\((A\\cap B) \\cap (A^c\\cap B) = \\emptyset, (A\\cap B^c) \\cap (A^c\\cap B) = \\emptyset\\) であることがわじゃry．\n\n\n\n\n\nExercise 1.3 \n\\(A, B\\) を空集合ではない集合としたとき，以下の関係式は正しいと言えるか？\n\\[\n(A\\cup B) - A = B\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\nA\\cup B = A \\cup (B - A)\n\\]\nと互いに交わりのない集合のUnionと表記できるので\n\\[\nA\\cup B - A = B - A \\subset B\n\\]\n\\(A \\cap B \\neq \\emptyset\\) のとき，\\(B \\not\\subset B-A\\), つまり \\(B - A \\neq B\\)となるので関係式は正しくない．\n\n\n\n\n\nExercise 1.4 \n\\(A, B, C\\) を空集合ではない集合としたとき，以下の関係式は正しいと言えるか？\n\\[\n(A\\cup B) - C = A- (B - C)\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n\\begin{align*}\n\\text{LHS} &= (A\\cup B) \\cap C^c\\\\\n           &= (A\\cap C^c) \\cup (B \\cap C^c)\\\\\n\\Rightarrow& ((A\\cap C^c) \\cup (B \\cap C^c))\\cap C = \\emptyset\n\\end{align*}\n\\]\n\\[\n\\begin{align*}\n\\text{RHS} &= A\\cap (B \\cap C^c)^c\\\\\n           &= A\\cap (B^c \\cup C)\\\\\n           &= (A\\cap B^c) \\cup (A\\cap C)\\\\\n\\Rightarrow& ((A\\cap B^c) \\cup (A\\cap C)) \\cap C \\neq \\emptyset\n\\end{align*}\n\\]\nしたがって，\\(\\text{LHS} \\neq \\text{RHS}\\)となり，与えられた関係式は正しくない．\n\n\n\n\n\nExercise 1.5 \n\\(A, B, C\\) を空集合ではない集合としたとき，以下の関係式を示せ\n\\[\nA\\cap B \\cap C \\subset (A\\cap B) \\cup (B\\cap C) \\cup (A\\cap C)\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n\\begin{align*}\nA\\cap B \\cap C &\\subset A\\cap B \\subset (A\\cap B) \\cup (B\\cap C) \\cup (A\\cap C)\n\\end{align*}\n\\]\n\n\n\n\n\nExercise 1.6 ポーカーと集合 \nポーカーを考える．５枚のカードの組合せ全体を \\(\\Omega\\) としたとき，以下の事象の包含関係を調べよ\n\n事象A: 同じ数字のカードが２枚以上存在する組み合わせ\n事象B: 同じ数字のカードが３枚以上存在する組み合わせ\n事象C: 同じ数字のカードが４枚以上存在する組み合わせ\n事象D: 同じ数字のカードが２枚以上あるのが２種類ある組み合わせ\n事象E: フルハウス\n事象F: ワンペア\n事象G: ツーペア\n事象H: スリーカーズ\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n\\begin{align*}\nC &\\subset B \\subset A\\\\\nD &\\subset A\\\\\nE &= B \\cap D\\\\\nF &= (A - B) \\cap (A - D) = A \\cap (B\\cup D)^c \\\\\nG &= D - B\\\\\nH &= (B - C) \\cap (B - D) = B \\cap (C \\cup D)^c\\\\\nB - D &= B - E\\\\\nD - B &= D - E\\\\\n\\end{align*}\n\\]\n\n\n\n\n\nExercise 1.7 \n上述のポーカーと集合問題において，\\(\\Omega\\) 及び各 \\(A\\)~\\(H\\) 事象の個数（＝カードの組み合わせ数）を求めよ．\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n以下では \\(\\sharp(\\cdot)\\) で集合の個数を表すとする．\n\\[\n\\begin{align*}\n\\sharp(\\Omega) = {}_{52}C_5 = 2598960\n\\end{align*}\n\\]\n\\(\\sharp(A) = \\sharp(\\Omega) - \\sharp(A^c)\\) なので\n\\[\n\\begin{align*}\n&\\sharp(A^c) = {}_{13}C_5 \\times 4^5 = 1317888\\\\\n\\Rightarrow &\\sharp(A) = 2598960 - 1317888 = 1281072\n\\end{align*}\n\\]\n\\(C\\) の個数は，事実上フォーカーズの個数と同じなので\n\\[\n\\sharp(C) = {}_{13}C_1 \\times 48 = 624\n\\]\nフルハウス \\(E\\) の個数は\n\\[\n\\begin{align*}\n\\sharp(E) &= {}_{13}C_2 \\times 2 {}_{4}C_3 \\times 2 {}_{4}C_2\\\\\n          &= 3744\n\\end{align*}\n\\]\nツーペア \\(G\\) の個数は, ペアとして選ばれた数値のカード８枚分を引いた44枚の中からドベカードを選ぶ必要があるので\n\\[\n\\begin{align*}\n\\sharp(G) &= {}_{13}C_2 \\times {}_{4}C_2 \\times {}_{4}C_2 \\times 44\\\\\n          &= 123552\n\\end{align*}\n\\]\nスリーカーズ \\(H\\) は \\(H = B \\cap (C \\cup E)^c = (B - C) - E\\) かつ \\(E \\subset (B - C)\\) となるので，\n\\[\n\\begin{align*}\n&\\sharp(B-C) = {}_{13}C_1 \\times {}_{4}C_3 \\times 48 = 58656\\\\\n\\Rightarrow& \\sharp(H) = 58656 - 3744 = 54912\n\\end{align*}\n\\]\nまた，同様の議論より\n\\[\n\\begin{align*}\n\\sharp(B) = \\sharp(B-C) + \\sharp(C) = 58656 + 624 = 59280\n\\end{align*}\n\\]\nワンペア集合 \\(F\\) は 集合 \\(A\\) から ツーペア \\(G\\), スリーカーズ \\(H\\), フォーカーズ \\(C\\), フルハウス \\(E\\) を引けば良いので\n\\[\n\\sharp(F) = 1281072 - 123552 - 54912 - 624 - 3744 = 1098240\n\\]\n\\(D - E = G\\) 及び \\(E \\cap G = \\emptyset\\) という関係から \\(\\sharp(D) = \\sharp(E) + \\sharp(G)\\) となる．従って，\n\\[\n\\sharp(D) = 3744 + 123552 = 127296\n\\]\n\n📘 REMARKS \n組み合わせで表された各標本点は同様に確からしいと考えられるので，各事象の確率は\n\\[\n\\Pr(A) = \\frac{\\sharp(A)}{\\sharp(\\Omega)}\n\\]\nで考えることができる．\nまた，ワンペア \\(F\\) 個数の別解として，ペアの数字を一つ選んでから残りはバラバラの数字となることとも考えられるので\n\\[\n\\sharp(F) = _{13}C_1 \\times _{4}C_2 \\times _{12}C_3 \\times 4^3 = 1098240\n\\]\nと求めても良い．\n\n\n\n\n\n\nExercise 1.8 \nRをもちいて，ワンペア，ツーペア，フルハウス，スリーカーズ，フォーカーズの場合の数を確かめよ．\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\nlibrary(combinat)\n\n\nAttaching package: 'combinat'\n\n\nThe following object is masked from 'package:utils':\n\n    combn\n\nlibrary(parallel)\n\nnum_cores &lt;- 20\n\n# Generate the suits and ranks\nsuits &lt;- c(\"H\", \"D\", \"H\", \"S\")\nranks &lt;- c(\"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"J\", \"Q\", \"K\", \"A\")\n\n# Create the deck of cards\ndeck &lt;- paste(rep(ranks, each = 4), suits, sep = \"-\")\n\n# Create all combinations\nall_hands &lt;- combn(deck, 5, simplify = FALSE)\n\n# Function to check the rank frequency in a hand\ncheck_hand &lt;- function(hand) {\n  hand_ranks &lt;- sapply(strsplit(hand, \"-\"), `[`, 1)\n  rank_table &lt;- table(hand_ranks)\n  return(rank_table)\n}\n\nhand_types &lt;- mclapply(all_hands, function(hand) {\n  rank_table &lt;- check_hand(hand)\n  \n  if (max(rank_table) == 4) {\n    return(\"Four Cards\")\n  } else if (max(rank_table) == 3 && any(rank_table == 2)) {\n    return(\"Full House\")\n  } else if (max(rank_table) == 3) {\n    return(\"Three Cards\")\n  } else if (sum(rank_table == 2) == 2) {\n    return(\"Two Pair\")\n  } else if (any(rank_table == 2)) {\n    return(\"One Pair\")\n  } else {\n    return(\"High Card\")\n  }\n}, mc.cores = num_cores)\n\n# Summary of hand types\ntable(unlist(hand_types))\n\n\n Four Cards  Full House   High Card    One Pair Three Cards    Two Pair \n        624        3744     1317888     1098240       54912      123552",
    "crumbs": [
      "確率基礎",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>集合演算と確率</span>"
    ]
  },
  {
    "objectID": "posts/statistics101/probability_and_set.html#事象と確率",
    "href": "posts/statistics101/probability_and_set.html#事象と確率",
    "title": "1  集合演算と確率",
    "section": "事象と確率",
    "text": "事象と確率\n\n\nExercise 1.9 \nコインを一回投げて，表をH, 裏をTとした場合の標本空間と事象を列挙せよ\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n標本空間は\n\\[\n\\Omega = \\{H, T\\}\n\\]\n事象は \\(2^\\text{標本点の数} = 4\\) 個存在する．それらを書き出すと以下，\n\\[\n\\{H, T\\}, \\{H\\}, \\{T\\}, \\emptyset\n\\]\n\n\n\n\n\nExercise 1.10 \n\\(A\\subset B\\) なる確率事象A, Bに対して \\(\\Pr(A)\\leq \\Pr(B)\\) を示せ\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\(B = A^c \\cap B \\cup A \\cap B\\) および \\((A^c \\cap B) \\cap (A \\cap B) = \\emptyset\\) より\n\\[\n\\begin{align*}\n\\Pr(B) &= \\Pr(A^c \\cap B) + \\Pr(A \\cap B)\\\\\n       &\\geq \\Pr(A \\cap B)\n\\end{align*}\n\\]\n\\(A\\subset B\\) より \\(A \\cap B = A\\). 従って，\n\\[\n\\begin{align*}\n\\Pr(B) &= \\Pr(A^c \\cap B) + \\Pr(A \\cap B)\\\\\n       &\\geq \\Pr(A \\cap B) = \\Pr(A)\n\\end{align*}\n\\]\nよって，\\(\\Pr(A)\\leq \\Pr(B)\\) が成立する．\n\n\n\n\n\nExercise 1.11 \n確率事象 \\(A_1, A_2, \\cdots, A_n\\) について\n\\[\n\\Pr(\\bigcup_{i=1}^n A_i) \\leq \\sum_{i=1}^n\\Pr(A_i)\n\\]\nが成立することを示せ．\n\n\n\n\n\n\n\n\nSolution - 数学的帰納法\n\n\n\n\n\n数学的帰納法を用いいて示す. \\(n=1\\) のときは，\n\\[\n\\Pr(A_{1}) \\leq \\Pr(A_{1})\n\\]\nより成立．\\(n=2\\) のときも，\n\\[\n\\Pr(A_{1} \\cup A_{2}) = \\Pr(A_{1}) + \\Pr(A_{2}) - \\Pr(A_{1}\\cap A_{2}) \\leq \\Pr(A_{1}) + \\Pr(A_{2})\n\\]\nより成立．\\(n\\) のとき成り立つと仮定すると，仮定より \\(\\Pr(\\bigcup_{i=1}^n A_i)\\leq \\sum_{i=1}^n\\Pr(A_i)\\).\n\\[\n\\begin{align*}\n\\Pr(\\bigcup_{i=1}^{n+1} A_i) &= \\Pr((\\bigcup_{i=1}^n A_i)\\cup A_{n+1})\\\\\n                             &\\leq \\Pr(\\bigcup_{i=1}^n A_i) + \\Pr(A_{n+1})\\\\\n                             &\\leq \\sum_{i=1}^n\\Pr(A_i) + \\Pr(A_{n+1})\\\\\n                             &= \\sum_{i=1}^{n+1}\\Pr(A_i)\n\\end{align*}\n\\]\n以上より，\\(n+1\\) のときにも成り立つことがわかる．\n\n\n\n\n\n\n\n\n\nSolution - 排反事象の定義を用いた証明\n\n\n\n\n\n\\(B_1 = A_1, B2 = A_2 \\cap B_1^c, \\cdots, B_i = A_i \\cap (B_1\\cup \\cdots \\cup B_{i-1})^c\\) と定義する． このとき，\\(B_i \\cap B_j = \\emptyset\\) で\n\\[\n\\bigcup_{i} A_i = \\bigcup_{i} B_i\n\\]\nが成立することをまず確かめる．\n ▶  排反性\n\\(i &lt; j\\) について\n\\[\n\\begin{align*}\nB_j &= A_j \\cap (B_1 \\cup \\cdots \\cup B_i \\cup \\cdots B_{j-1})^c\\\\\n    &\\subset (B_1 \\cup \\cdots \\cup B_i \\cup \\cdots B_{j-1})^c\\subset B_i^c\n\\end{align*}\n\\]\n従って，\\(B_i \\cap B_j = \\emptyset\\)\n ▶  事象の和\n\\(B_i \\subset A_i\\) より\n\\[\n\\begin{align*}\n\\bigcup B_i \\subset \\bigcup A_i\n\\end{align*}\n\\]\nつぎに，\\(w\\in \\bigcup A_i\\) のとき，\\(w \\in A_1\\) ならば \\(w\\in B_1\\) なので \\(w \\in \\bigcup B_i\\). \\(w \\in A_i \\ \\ (i &gt; 1)\\) のときは，\\(B_i = A_i \\cap (B_1 \\cup \\cdots \\cup B_{i-1})^c\\) であることに留意すると，\n\n\\(w \\in (B_1 \\cup \\cdots \\cup B_{i-1})^c\\) ならば \\(w\\in B_i\\) となり, \\(w \\in \\bigcup B_i\\).\n\\(w \\not \\in (B_1 \\cup \\cdots \\cup B_{i-1})^c\\) ならば \\(w \\in B_1 \\cup \\cdots \\cup B_{i-1}\\) となり, \\(w \\in  \\bigcup B_i\\)\n\n従って，いずれの場合でも \\(\\bigcup A_i \\subset \\bigcup B_i\\) が成立するので\n\\[\n\\bigcup B_i = \\bigcup A_i\n\\]\nとなる．\n ▶  Conclusion\n\\(B_i \\subset A_i\\) より \\(\\Pr(B_i) \\leq \\Pr(A_i)\\) は自明．また上記と合わせると\n\\[\n\\begin{align*}\n\\Pr(\\bigcup_{i=1}^n A_i) &= \\Pr(\\bigcup_{i=1}^n B_i)\\\\\n                         &= \\sum_i \\Pr(B_i)\\\\\n                         &\\leq \\sum_i \\Pr(A_i)\n\\end{align*}\n\\]\nとなり題意は示せた．\n\n\n\n\n\nExercise 1.12 \nA, B, Cを事象とする．次の事象を式で表せ\n\nA,B,CのうちAだけが発生する\nA,B,Cのうち少なくとも２つが起きる\nA,B,Cどれも起きない\nA,B,Cのうち，２つ以上の事象は同時には起きない\nA,B,Cのうち，３つ全部起きるか，どれも起きないかのいずれか\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n ▶  (1) A,B,CのうちAだけが発生する\n\\[\nA - (B\\cup C) = A \\cap B^c \\cap C^c\n\\]\n ▶  (2) A,B,Cのうち少なくとも２つが起きる\n\\[\n(A\\cap B) \\cup (B\\cap C) \\cup (A\\cap C)\n\\]\n ▶  (3) A,B,Cどれも起きない\n\\[\n(A\\cup B\\cup C)^c = A^c \\cap B^c \\cap C^c\n\\]\n ▶  (4) A,B,Cのうち，２つ以上の事象は同時には起きない\n(2)の余集合に相当するので\n\\[\n\\begin{align*}\n&(A - (B\\cup C)) \\cup (B - (A\\cup C)) \\cup (C - (A\\cup B)) \\cup (A^c \\cap B^c \\cap C^c)\\\\\n&=((A\\cap B) \\cup (B\\cap C) \\cup (A\\cap C))^c\n\\end{align*}\n\\]\nRでRHSとLHSが一致するかを以下確認します．\n\n\nCode\nlibrary(ggVennDiagram)\nlibrary(ggplot2)\nset.seed(42)\n\n# genesがsample space omegaに相当\ngenes &lt;- paste(\"gene\",1:1000,sep=\"\")\nx &lt;- list(A=sample(genes,300),\n          B=sample(genes,300),\n          C=sample(genes,300))\n\nggVennDiagram(x)\n\n\n\n\n\n\n\n\n\nCode\n# RHS setoperation\nrhs_set &lt;- list(AB_inter=intersect(x$A, x$B),\n                BC_inter=intersect(x$B, x$C),\n                AC_inter=intersect(x$A, x$C))\nunion_set &lt;- Reduce(union, rhs_set)\nrhs_answer &lt;- setdiff(genes, union_set)\n\n# LHS setoperation\ny &lt;- list(A=setdiff(x$A, union(x$B, x$C)),\n          B=setdiff(x$B, union(x$A, x$C)),\n          C=setdiff(x$C, union(x$A, x$B)),\n          D=setdiff(genes, Reduce(union, x)))\nlhs_answer &lt;- Reduce(union, y)\n\n\n結果を確認してみると\n\n# visualize\nggVennDiagram(list(LHS=lhs_answer, RHS=rhs_answer))\n\n\n\n\n\n\n\nsetequal(lhs_answer, rhs_answer)\n\n[1] TRUE\n\n\n上記のように結果が一致することを確かめられました．\n ▶  (5) A,B,Cのうち，３つ全部起きるか，どれも起きないかのいずれか\n\\[\n(A\\cap B\\cap C) \\cup (A^c \\cap B^c \\cap C^c)\n\\]\n\n\n\n\n\nExercise 1.13  3つのボールa,b,cを３つの箱の中に分配するという実験を考える．この実験の結果，例えば第１の箱に３つとも入ったときには\n\\[\n[abc|\\emptyset|\\emptyset]\n\\]\nと表記するとする．このとき，すべての標本点は何通り存在するか？\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n３つのボールについて３つのアサインメント先がそれぞれ考えられるので，\n\\[\n3^3 = 27 \\text{通り}\n\\]\n\n\n\n\n\nExercise 1.14  区別できない3つのボールを区別できる３つの箱の中に分配するという実験を考える．この実験の結果，\n\n第１の箱に３つとも入ったときには \\([3,0,0]\\)\n第１の箱に2つ, 第２の箱に１つ入ったときには \\([2,1,0]\\)\n\nと表記するとする．このとき，すべての標本点は何通り存在するか？\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n区別できないボール３つに対して，両端を含むボールの間４つの候補から仕切りを２つ選ぶ問題と同じみなせるので ４つから２つ重複ありの組み合わせを選ぶ問題, \\({}_4H_2\\) と考えることができる．\nしたがって，\n\\[\n\\begin{align*}\n{}_4H_2 = {}_{4+2-1}C_2 = 10\\text{通り}\n\\end{align*}\n\\]\n\n\n\n\n\nExercise 1.15  区別できない3つのボールを区別できる３つの箱の中に分配するという実験を考える．この実験の結果， 第１と第２の箱が空ではない確率を求めよ．\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\([2, 1, 0], [1, 1, 1], [1, 2, 0]\\)が条件を標本点となりことから，多項分布の問題の問題と考えることができます．\n\\[\n\\begin{align*}\nP((2, 1, 0)) &= \\frac{3!}{2!1!}\\left(\\frac{1}{3}\\right)^2\\left(\\frac{1}{3}\\right)^1\\\\\nP((1, 1, 1)) &= \\frac{3!}{1!1!1!}\\left(\\frac{1}{3}\\right)\\left(\\frac{1}{3}\\right)\\left(\\frac{1}{3}\\right)\\\\\nP((1, 2, 0)) &= \\frac{3!}{1!2!}\\left(\\frac{1}{3}\\right)^1\\left(\\frac{1}{3}\\right)^2\n\\end{align*}\n\\]\nそれぞれの事象は排反なので，和を取ることで第１と第２の箱が空ではない確率が求まります．したがって，\n\\[\nP(\\text{第１と第２の箱が空ではない確率})=\\frac{4}{9}\n\\]\n\nWARNING ! \n\n標本点 \\([2, 1, 0], [1, 1, 1], [1, 2, 0]\\), 標本空間の要素数10通りというところから，\\(4/10=0.4\\)と計算することはできない\n「標本点がすべて同程度に確からしい」という仮定を満たしていないのが理由\n\n\n\n\n\n\n\nExercise 1.16  上と同様に区別できない3つのボールを区別できる３つの箱の中に分配するという実験を考える．この実験の結果， 第１の箱に１つ以上のボールが入っている確率を求めよ\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n「第１の箱に１つ以上のボールが入っている」という事象Aは「第１の箱に０このボールが入っている」の余事象となるので \\(1 - \\Pr(A^c)\\)で求まる．したがって，\n\\[\n1 - \\Pr(A^c) = 1 - \\left(\\frac{2}{3}\\right)^3 = \\frac{19}{27}\n\\]\nが答えとなる．\n\n\n\n\n\nExercise 1.17 \nA国の人は10%がrich, 7%がfamous, 5%がrich and famousであることが知られている．このとき無作為に選ばれた１人について，以下の事象の確率を求めよ\n\n\\(\\Pr(\\text{not rich})\\)\n\\(\\Pr(\\text{rich but not famous})\\)\n\\(\\Pr(\\text{rich or famous})\\)\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n ▶  (1) \\(\\Pr(\\text{not rich})\\) \n事象richを\\(R\\)と表すと，事象not richは\\(R^c\\)と表せるので\n\\[\n\\Pr(\\text{not rich}) = 1 - \\Pr(R) = 0.9\n\\]\n ▶  (2) \\(\\Pr(\\text{rich but not famous})\\)\n事象famousを\\(F\\)と表すと，事象rich but not famousは\\(R \\cap F^c\\)．したがって，\n\\[\n\\begin{align*}\n\\Pr(\\text{rich but not famous}) &= \\Pr(R \\cap F^c)\\\\\n                                &= \\Pr(R \\backslash F)\\\\\n                                &= \\Pr(R) - \\Pr(R\\cap F)\\\\\n                                &= 0.1 - 0.05 = 0.05\n\\end{align*}\n\\]\n ▶  (3) \\(\\Pr(\\text{rich or famous})\\)\n事象rich or famousは\\(R\\cup F\\)と表現できるので\n\\[\n\\Pr(\\text{rich or famous}) = \\Pr(R) + \\Pr(F) - \\Pr(R\\cap F) = 0.12\n\\]\n\n\n\n\n\nExercise 1.18 捕獲再捕獲法 \n池の魚の数 \\(N\\) を推定したい．まず \\(m\\) 匹の魚を捕り，マークをつけて池に再び放した． しばらくしてから，再び \\(n\\) 匹の魚をランダムに採取したところ，その内 \\(k\\) 匹の魚にマークがついていた．\nどの魚も捕獲される否かは，独立に同一分布に従っていると仮定したとき，魚の総数 \\(N\\) の最尤推定値を求めよ．\n\n\nCode\nlibrary(eulerr)\nset.seed(42)\n# move to new plotting page \nD &lt;-list('Total N'=1:20,'m-k'=1:8, \n         'n-k'=6:10, 'k'= 6:6) \n\n# creating venn diagram for four sets \nD_eulerr &lt;- euler(D)\nplot(D_eulerr, quantities = FALSE, fill = \"transparent\", lty = c(1,1,1,0), labels = list(font = 4))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nパラメーターが \\(N\\) の尤度関数 \\(L(N)\\)は．\n\\[\nL(N) = \\frac{{}_mC_k {}_{N-m}C_{n-k}}{{}_NC_n}\n\\]\nこれを最大にする整数 \\(N\\) を求めたい．ここで以下のような式を露わに定義する\n\\[\n\\begin{align*}\n\\frac{L(N)}{L(N-1)} &= \\frac{{}_mC_k {}_{N-m}C_{n-k}}{{}_NC_n}\\frac{{}_{N-1}C_n}{{}_mC_k {}_{N-1-m}C_{n-k}}\\\\[6pt]\n                    &= \\frac{(N-m)(N-n)}{N(N-m-n+k)}\\\\[6pt]\n                    &= \\frac{N^2 - (n+m)N +mn}{N^2 - (n+m)N +kN}\n\\end{align*}\n\\]\n従って，\n\\[\n\\begin{align*}\n\\frac{L(N)}{L(N-1)} &&gt; 1 \\Leftrightarrow N &lt; mn/k\\\\\n\\frac{L(N)}{L(N-1)} &= 1 \\Leftrightarrow N = mn/k\\\\\n\\frac{L(N)}{L(N-1)} &&lt; 1 \\Leftrightarrow N &gt; mn/k\n\\end{align*}\n\\]\n従って，\n\\[\n\\hat N = \\begin{cases}\nmn/k, mn/k - 1 & (mn/k: \\text{整数})\\\\\n\\lfloor mn/k, \\rfloor & (\\text{otherwise})\n\\end{cases}\n\\]",
    "crumbs": [
      "確率基礎",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>集合演算と確率</span>"
    ]
  },
  {
    "objectID": "posts/statistics101/conditional_probability.html",
    "href": "posts/statistics101/conditional_probability.html",
    "title": "2  条件付き確率",
    "section": "",
    "text": "条件付き確率と独立性",
    "crumbs": [
      "確率基礎",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>条件付き確率</span>"
    ]
  },
  {
    "objectID": "posts/statistics101/conditional_probability.html#条件付き確率と独立性",
    "href": "posts/statistics101/conditional_probability.html#条件付き確率と独立性",
    "title": "2  条件付き確率",
    "section": "",
    "text": "Exercise 2.1 \n空集合ではない事象 A, Bの間に\n\\[\n\\Pr(B\\vert A) = \\Pr(B\\vert A^c)\n\\]\nという関係があるとき，A, Bは互いに独立であることを示せ．\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\n\\((A\\cap B) \\cup (A^c\\cap B) = B\\)\n\\((A\\cap B) \\cap (A^c\\cap B) = \\emptyset\\)\n\nに留意すると\n\\[\n\\begin{align*}\n&\\Pr(A\\cap B) + \\Pr(A^c\\cap B) = \\Pr(B)\\\\\n&\\Pr(A\\cap B) = \\Pr(B) - \\Pr(A^c\\cap B)\n\\end{align*}\n\\]\n\\(\\Pr(B\\vert A) = \\Pr(B\\vert A^c)\\)と問題文より与えられているので\n\\[\n\\begin{align*}\n&\\frac{\\Pr(B) - \\Pr(A^c\\cap B)}{\\Pr(A)} = \\frac{\\Pr(A^c \\cap B)}{1 - \\Pr(A)}\\\\\n&\\Rightarrow \\Pr(B) - \\Pr(A^c\\cap B) -\\Pr(A)\\Pr(B) + \\Pr(A)\\Pr(A^C\\cap B) = \\Pr(A)\\Pr(A^C\\cap B)\\\\\n&\\Rightarrow \\Pr(B) - \\Pr(A^c\\cap B) = \\Pr(A)\\Pr(B)\\\\\n&\\Rightarrow \\Pr(A\\cap B) = \\Pr(A)\\Pr(B)\n\\end{align*}\n\\]\nしたがって，事象A, Bは独立\n\n\n\n\n\nExercise 2.2 \n事象A, Bが独立のとき，以下が成立することを示せ．ただし，\\(0 &lt; \\Pr(A) &lt; 1\\)とする．\n\\[\n\\Pr(B \\vert A) = \\Pr(B \\vert A^c)\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\n事象 A, Bが独立なので定義より \\(\\Pr(A\\cap B) = \\Pr(A)\\Pr(B)\\Rightarrow \\Pr(B\\vert A)=\\Pr(B)\\)\n\\(A\\) と \\(A^c\\) は排反なので, \\(\\Pr(B) = \\Pr(A\\cap B) + \\Pr(A^c\\cap B)\\)\n\n従って，\n\\[\n\\begin{align*}\n\\Pr(B\\vert A^c) &= \\frac{\\Pr(B) - \\Pr(A\\cap B) }{\\Pr(A^c)}\\\\\n                &= \\frac{(1 - \\Pr(A))\\Pr(B)}{\\Pr(A^c)}\\\\\n                &= \\Pr(B)\n\\end{align*}\n\\]\n従って，\\(\\Pr(B\\vert A) = \\Pr(B\\vert A^c) = \\Pr(B)\\) が成り立つ．\n\n\n\n\n\n\n\n\n\nSolution - 加比の理\n\n\n\n\n\n事象の独立性より \\(\\Pr(B\\vert A) = \\Pr(B)\\) は明らか．次に，\n\\[\n\\begin{align*}\n\\Pr(B) &= \\frac{\\Pr(B)}{1}\\\\\n       &= \\frac{\\Pr(A\\cap B)}{\\Pr(A)}\\\\\n       &= \\frac{\\Pr(B) - \\Pr(A\\cap B)}{1 - \\Pr(A)} \\because{\\text{加比の理}}\\\\\n       &= \\frac{\\Pr(A^c\\cap B)}{\\Pr(A^c)}\\\\\n       &= \\Pr(B\\vert A^c)\n\\end{align*}\n\\]\n従って, \\(\\Pr(B\\vert A) = \\Pr(B\\vert A^c) = \\Pr(B)\\) が成り立つ.\n\n\n\n\n\nExercise 2.3 \n条件付き確率について,\n\\[\n\\begin{align*}\n\\Pr(A\\vert D) &\\geq \\Pr(B\\vert D)\\\\\n\\Pr(A\\vert D^c) &\\geq \\Pr(B\\vert D^c)\n\\end{align*}\n\\]\nが成立しているとき, \\(\\Pr(A)\\geq \\Pr(B)\\) であることを示せ．\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n\\begin{align*}\n\\Pr(A) &= \\Pr(A\\vert D)\\Pr(D) + \\Pr(A\\vert D^c)\\Pr(D^c)\\\\\n       &\\geq \\Pr(B\\vert D)\\Pr(D) + \\Pr(B\\vert D^c)\\Pr(D^c)\\\\\n       &= \\Pr(B)\n\\end{align*}\n\\]\n\n\n\n\n\nExercise 2.4 ペアワイズ独立性 \n空集合ではない確率事象 A, B, C を考える．AとBが独立，BとCが独立のとき, AとCは独立であると言えるか？ 成立しない場合は反例を述べよ．\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\(\\Omega = {w_1, w_2, w_3, w_4}\\), 標本点すべてが同程度に確からしい, \\(A = \\{w_1, w_2\\}\\), \\(B = \\{w_2, w_3\\}\\), \\(C = \\{w_3, w_4\\}\\)，と確率事象が定義されたとき，\n\\[\n\\begin{align*}\n\\Pr(A \\cap B) &= \\frac{1}{4} = \\Pr(A)\\Pr(B)\\\\\n\\Pr(B \\cap C) &= \\frac{1}{4} = \\Pr(B)\\Pr(C)\n\\end{align*}\n\\]\nとAとBが独立，BとCが独立となるが，\n\\[\n\\Pr(A \\cap C) = 0 \\neq \\Pr(A)\\Pr(C)\n\\]\nとなり, A と C は独立でない．\n\n\n\n\n\nExercise 2.5 ペアワイズ独立性 \n\\(\\Omega = \\{w_1, w_2, w_3, w_4\\}\\), 標本点すべてが同程度に確からしい, \\(A = \\{w_1, w_2\\}\\), \\(B = \\{w_1, w_3\\}\\), \\(C = \\{w_1, w_4\\}\\)と事象が定義され， 各根元事象の\n\\[\n\\Pr(\\{w_i\\}) = \\frac{1}{4} \\space (i=1,2,3,4)\n\\]\nこのとき，事象A, B, Cのどの２つも独立（=ペアワイズ独立）だが，３つの事象A, B, Cは互いに独立でないことを示せ\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n ▶  任意の２つ事象の独立性\n\\(A\\cap B = B\\cap C = C\\cap A = \\{w_1\\}\\)\nより\n\\[\n\\begin{align*}\n\\Pr(A\\cap B) &= \\Pr(A)\\Pr(B) = \\frac{1}{4}\\\\\n\\Pr(B\\cap C) &= \\Pr(B)\\Pr(C) = \\frac{1}{4}\\\\\n\\Pr(A\\cap C) &= \\Pr(A)\\Pr(A) = \\frac{1}{4}\n\\end{align*}\n\\]\nしたがって，\\(A\\perp B, B\\perp C, A\\perp C\\)が成立する．\n ▶  ３つの事象A, B, Cの組の独立性\n３つの事象A, B, Cの組の独立性するということは\n\\[\n\\Pr(A\\cap B \\cap C) = \\Pr(A)\\Pr(B)\\Pr(C)\n\\]\nが成立するすることが必要十分条件．一方，\n\\[\n\\begin{align*}\n\\Pr(A\\cap B \\cap C) &= \\Pr(\\{w_1\\}) = \\frac{1}{4}\\\\\n\\Pr(A)\\Pr(B)\\Pr(C) &= \\frac{1}{8}\n\\end{align*}\n\\]\n従って，\\(\\Pr(A\\cap B \\cap C) \\neq \\Pr(A)\\Pr(B)\\Pr(C)\\)",
    "crumbs": [
      "確率基礎",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>条件付き確率</span>"
    ]
  },
  {
    "objectID": "posts/statistics101/conditional_probability.html#条件付き確率モデル",
    "href": "posts/statistics101/conditional_probability.html#条件付き確率モデル",
    "title": "2  条件付き確率",
    "section": "条件付き確率モデル",
    "text": "条件付き確率モデル\n\n\nExercise 2.6 \n2人の子供のいる夫婦について，子供に一人が女のことであるという条件のもとで２人共女の子である確率をもとめよ\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n少なくとも子供の一人が女の子である確率は, 子供二人共男の子である確率事象 \\(A\\) の余事象とみなせるので\n\\[\n\\Pr(A^c) = 1- \\frac{1}{4} = \\frac{3}{4}\n\\]\n二人共女の子である確率事象 Bは \\(B \\subset A^c\\) なので, \\(B \\cap A^c = B\\)．従って，\n\\[\n\\begin{align*}\n\\Pr(B \\vert A^c) &= \\frac{\\Pr(A^c \\cap B)}{\\Pr(A^c)}\\\\\n                 &= \\frac{\\Pr(B)}{\\Pr(A^c)}\\\\\n                 &= \\frac{1}{3}\n\\end{align*}\n\\]\n\n\n\n\n\nExercise 2.7 \nあたりが \\(m &gt;0\\) 本, はずれが \\(n\\) 本あるくじを２つのプレイヤーが1回ずつ引く場合，先攻と後攻どちらが有利か？\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n\\begin{align*}\n\\Pr(\\text{先攻が当たりを引く}) &= \\frac{m}{m+n}\\\\\n\\Pr(\\text{後攻が当たりを引く}) &= \\Pr(\\text{後攻が当たりを引く}\\vert \\text{先攻が当たりを引く})\\Pr(\\text{先攻が当たりを引く}) + \\Pr(\\text{後攻が当たりを引く}\\vert \\text{先攻がはずれを引く})\\Pr(\\text{先攻がはずれを引く})\\\\\n                            &= \\frac{m-1}{m+n-1}\\frac{m}{m+n} + \\frac{m}{m+n-1}\\frac{n}{m+n}\\\\\n                            &= \\frac{(m+n-1)(m)}{(m+n-1)(m+n)}\\\\\n                            &= \\frac{m}{m+n}\n\\end{align*}\n\\]\n従って，当たりを引く確率の最大化という観点では有利不利は存在しない．\n\n\n\n\n\nExercise 2.8 \n\nある製品を作る機械が3台あり, A, B, Cとする．\nA, B, Cはそzれぞれ全体の20%, 30%, 50%の製品を生産している\nA, B, Cの各機械から生産される製品について，それぞれ5%, 4%, 2% の割合で不良品が混ざっていることが知られている\n\n上記の設定において，製品全体からランダムに1個とりだしたとき，それが不良品である確率はいくつか？また，取り出しした製品が不良品であることを条件としたとき， その製品を生産した機械がA, B, Cである確率をそれぞれ求めよ\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n ▶  不良品の確率\nランダムに取り出した製品が不良品である確率事象をDとすると\n\\[\n\\begin{align*}\n\\Pr(D) &= \\Pr(D\\cap A) + \\Pr(D\\cap B) + \\Pr(D\\cap C)\\\\\n       &= \\Pr(D\\vert A)\\Pr(A) + \\Pr(D\\vert B)\\Pr(B) + \\Pr(D\\vert C)\\Pr(C)\\\\\n       &= \\frac{5}{100}\\frac{20}{100} + \\frac{4}{100}\\frac{30}{100} + \\frac{2}{100}\\frac{50}{100}\\\\\n       &= \\frac{4}{125}\n\\end{align*}\n\\]\n ▶  不良品生産機械の確率\n\\[\n\\begin{align*}\n\\Pr(A\\vert D) &= \\frac{100}{320} = \\frac{5}{16}\\\\\n\\Pr(B\\vert D) &= \\frac{120}{320} = \\frac{3}{8}\\\\\n\\Pr(C\\vert D) &= \\frac{100}{320} = \\frac{5}{16}\n\\end{align*}\n\\]",
    "crumbs": [
      "確率基礎",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>条件付き確率</span>"
    ]
  },
  {
    "objectID": "posts/statistics101/conditional_probability.html#causal-inference",
    "href": "posts/statistics101/conditional_probability.html#causal-inference",
    "title": "2  条件付き確率",
    "section": "Causal Inference",
    "text": "Causal Inference\n\n\nExercise 2.9 : MHE The Propensity Score Theorem (p81) \n\\(i\\) を観測単位のindexとしたとき，\\(D_i\\) を0,1を値域とするbinary確率変数，\\(X_i\\) をcovariate確率変数のベクトル， \\(\\{Y_{0i}, Y_{1i}\\}\\) を \\(D_i\\) の値に対応したPotential Outcomeの組とする．\n\\[\n\\begin{align*}\n\\{Y_{0i}, Y_{1i}\\}{\\perp \\!\\!\\! \\perp} D_i\\vert X_i\n\\end{align*}\n\\]\nとCIAが成立するとき，以下が成立することを示せ：\n\\[\n\\begin{align*}\n&\\{Y_{0i}, Y_{1i}\\} {\\perp \\!\\!\\! \\perp} D_i\\vert p(X_i)\\\\[4pt]\n&\\text{where } p(X_i) \\equiv \\mathbb E[D_i\\vert X_i]\n\\end{align*}\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\(p(X_i)\\) をコントロールしたときに，Potential Outcomeの同時分布は \\(D_i\\) と独立であることが示せれば良いので，\n\\[\n\\Pr(D_i = 1 \\vert p(X_i), Y_{0i}, Y_{1i}) = \\Pr(D_i = 1 \\vert p(X_i)) = p(X_i)\n\\]\nであることが示せれば十分．\n\\[\n\\begin{align*}\n&\\Pr(D_i = 1 \\vert p(X_i), Y_{0i}, Y_{1i}) \\\\\n&= \\mathbb E[D_i \\vert p(X_i), Y_{0i}, Y_{1i}]\\\\\n&= \\mathbb E[\\mathbb E[D_i \\vert p(X_i), Y_{0i}, Y_{1i}]\\vert p(X_i), Y_{0i}, Y_{1i}]\\\\\n&= \\mathbb E[\\mathbb E[D_i \\vert p(X_i), Y_{0i}, Y_{1i}, X_i]\\vert p(X_i), Y_{0i}, Y_{1i}]\\\\\n&= \\mathbb E[\\mathbb E[D_i \\vert Y_{0i}, Y_{1i}, X_i]\\vert p(X_i), Y_{0i}, Y_{1i}]\n\\end{align*}\n\\]\nこのとき，問題の仮定より \\(\\{Y_{0i}, Y_{1i}\\}{\\perp \\!\\!\\! \\perp} D_i\\vert X_i\\) なので\n\\[\n\\begin{align*}\n&\\mathbb E[\\mathbb E[D_i \\vert Y_{0i}, Y_{1i}, X_i]\\vert p(X_i), Y_{0i}, Y_{1i}]\\\\\n&= \\mathbb E[\\mathbb E[D_i \\vert X_i]\\vert p(X_i), Y_{0i}, Y_{1i}]\\\\\n&= \\mathbb E[p(X_i) \\vert p(X_i), Y_{0i}, Y_{1i}]\\\\\n&= p(X_i)\n\\end{align*}\n\\]\n従って，\n\\[\n\\Pr(D_i = 1 \\vert p(X_i), Y_{0i}, Y_{1i}) = \\Pr(D_i = 1 \\vert p(X_i)) = p(X_i)\n\\]\n\n\n\n\n\nExercise 2.10 : MHE The Propensity Score and ATT (p82) \n上の問題と同じ設定のとき，以下を示せ．\n\\[\n\\mathbb E[Y_{1i} - Y_{0i}\\vert D_i = 1] = \\mathbb E\\bigg[\\frac{(D_i - p(X_i))Y_i}{(1 - p(X_i))\\Pr(D_i=1)}\\bigg]\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n\\mathbb E[Y_{1i} - Y_{0i}\\vert D_i = 1] = \\mathbb E[Y_{1i}\\vert D_i=1] - \\mathbb E[Y_{0i}\\vert D_i=1]\n\\]\nと分解できることに注目する．\n ▶  \\(\\mathbb E[Y_{1i}\\vert D_i=1]\\) について\n\\[\n\\begin{align*}\n&\\mathbb E[D_iY_i] = \\mathbb E[Y_{1i}\\vert D_i=1]\\Pr(D_i=1)\\\\[4pt]\n&\\Rightarrow \\mathbb E[Y_{1i}\\vert D_i=1] = \\frac{\\mathbb E[D_iY_i]}{\\Pr(D_i=1)} \\tag{a}\n\\end{align*}\n\\]\n ▶  \\(\\mathbb E[Y_{0i}\\vert D_i=1]\\) について\n\\[\n\\begin{align*}\n&\\mathbb E[Y_{0i}] = \\mathbb E[Y_{0i}\\vert D_i = 1] \\Pr(D_i = 1) + \\mathbb E[Y_{0i}\\vert D_i = 0] \\Pr(D_i = 0)\\\\[4pt]\n&\\Rightarrow \\mathbb E[Y_{0i}\\vert D_i = 1] \\Pr(D_i = 1) = \\mathbb E[Y_{0i}] - \\mathbb E[Y_{0i}\\vert D_i = 0] \\Pr(D_i = 0)\\\\[4pt]\n&\\Rightarrow E[Y_{0i}\\vert D_i = 1] \\Pr(D_i = 1) = \\mathbb E[Y_{0i}] - \\frac{\\mathbb E[(1 - D_i)Y_i]}{\\Pr(D_i = 0)}\\Pr(D_i = 0)\\\\[4pt]\n&\\Rightarrow E[Y_{0i}\\vert D_i = 1] = (\\mathbb E[Y_{0i}] - \\mathbb E[(1 - D_i)Y_i])/\\Pr(D_i = 1) \\tag{b}\n\\end{align*}\n\\]\n ▶  \\(\\mathbb E[Y_{0i}]\\) について\n\\[\n\\begin{align*}\n&\\mathbb E\\bigg[\\frac{(1 - D_i)Y_i}{1 - p(X_i)}\\bigg]\\\\[4pt]\n&= \\mathbb E\\bigg\\{\\mathbb E\\bigg[\\frac{(1 - D_i)Y_i}{1 - p(X_i)}\\bigg\\vert X_i\\bigg]\\bigg\\}\\\\[4pt]\n&= \\mathbb E\\bigg\\{\\frac{1}{1 - p(X_i)} (1 - p(X_i))\\mathbb E\\bigg[Y_{0i} \\vert X_i\\bigg]\\bigg\\}\\\\[4pt]\n&= \\mathbb E[Y_{0i}] \\tag{c}\n\\end{align*}\n\\]\n(a), (b), (c)より\n\\[\n\\begin{align*}\n&\\mathbb E[Y_{1i} - Y_{0i}\\vert D_i = 1]\\\\[4pt]\n&= \\frac{1}{\\Pr(D_i=1)}\\bigg(\\mathbb E[D_iY_i] - \\mathbb E\\bigg[\\frac{(1 - D_i)Y_i}{1 - p(X_i)}\\bigg] + \\mathbb E[(1 - D_i)Y_i] \\bigg)\\\\[4pt]\n&= \\frac{1}{\\Pr(D_i=1)}\\mathbb E\\bigg[Y_i - \\frac{(1 - D_i)Y_i}{1 - p(X_i)}\\bigg]\\\\[4pt]\n&= \\frac{1}{\\Pr(D_i=1)}\\mathbb E\\bigg\\{\\frac{(D_i - p(X_i))Y_i}{1 - p(X_i)}\\bigg\\}\\\\[4pt]\n&= \\mathbb E\\bigg[\\frac{(D_i - p(X_i))Y_i}{(1 - p(X_i))\\Pr(D_i=1)}\\bigg]\n\\end{align*}\n\\]",
    "crumbs": [
      "確率基礎",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>条件付き確率</span>"
    ]
  },
  {
    "objectID": "posts/statistics101/combination_permutation.html",
    "href": "posts/statistics101/combination_permutation.html",
    "title": "3  場合の数",
    "section": "",
    "text": "組み合わせと順列",
    "crumbs": [
      "確率基礎",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>場合の数</span>"
    ]
  },
  {
    "objectID": "posts/statistics101/combination_permutation.html#組み合わせと順列",
    "href": "posts/statistics101/combination_permutation.html#組み合わせと順列",
    "title": "3  場合の数",
    "section": "",
    "text": "Exercise 3.1 写像の個数 \n集合 \\(A = \\{1, 2, 3, \\cdots, r\\}, B = \\{1, 2, 3, \\cdots, n\\}, n\\geq r\\) を考える． このとき以下の条件を満たす写像 \\(f: A\\to B\\) はそれぞれ全部でいくつあるか？\n\n任意の写像\n１対１写像(＝単射)\n広義単調増加写像\n狭義単調増加写像\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n ▶  (1) 任意の写像\nAの各元について，Bの元の個数分の割当先が考えられるので \\(n^r\\) 個\n ▶  (2) １対１写像(＝単射)\n単射の定義として\n\\[\n(\\forall i, j \\in A) [i\\neq j\\Rightarrow f(i)\\neq f(j)]\n\\]\nBからr個の要素を順番に取り出す順列と対応することがわかる．従って，\n\\[\n\\text{単射の個数} = \\frac{n!}{(n-r)!}\n\\]\n ▶  (3) 広義単調増加写像 \nn個のツボにr個の区別できないボールを空ツボを許容して割り当てる問題と同一視できるので\n\\[\n\\text{広義単調増加写像の個数} = {}_nH_r = \\frac{n+r-1!}{r!(n-1)!}\n\\]\n ▶  (4) 狭義単調増加写像 \nn個元からr個選ぶ組み合わせの問題と同一視できるので\n\\[\n\\text{狭義単調増加写像の個数} = {}_nC_r = \\frac{n!}{r!(n-r)!}\n\\]\n\n\n\n\n\nExercise 3.2 \n\\[\nx + y + z = 6\n\\]\nを満たす非負の整数の組 \\((x, y, z)\\) は何組あるか？\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n6つのボールを区別できる３つのツボにアサインする問題と同一視できるので\n\\[\n{}_3H_6 = 28\\text{通り}\n\\]\n\n\n\n\n\nExercise 3.3 \n\\[\n{}_{n}P_r = {}_{n-1}P_r + r \\cdot {}_{n-1}P_{r-1}\n\\]\nを示せ\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n\\begin{align*}\n\\text{RHS} &= \\frac{(n-1!)}{(n-1-r)!} + r \\frac{(n-1!)}{(n-r)!} \\\\\n           &= (n-1)! \\bigg(\\frac{1}{(n-1-r)!} + \\frac{r}{(n-r)!}\\bigg)\\\\\n           &= (n-1)! \\frac{n + r - r}{(n-r)!}\\\\\n           &= \\frac{n!}{(n-r)!} = \\text{LHS}\n\\end{align*}\n\\]\n\n\n\n\n\nExercise 3.4 \n0から9を１回ずつ用いて一直線に並べる場合の数を求めよ．ただし，左右をひっくり返したものは同じと考える．\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n0から9を１回ずつ用いて一直線に並べる場合の数は \\(10!\\)．ここから左右ひっくり返したものを除かなくてはならないが， すべての要素が異なる順列に対しての反転なので，その数はちょうど半分となる．従って，\\(10!/2\\)\n\n\n\n\n\nExercise 3.5 \n赤玉５個，白玉４個を一直線に並べる場合の数を求めよ．ただし，左右をひっくり返したものは同じと考える．\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n一直線に並べる場合の数は\n\\[\n\\frac{9!}{5!}{4!}\n\\]\nこの内，左右対称となるもの(=ひっくり返したら同じになる並び順が存在しない組)は次の条件を満たすもの\n\n中央が赤玉\n左右の枠４個ずつについて，赤白がそれぞれ２個ずつ使用されている\n\nつまり，\\({}_{4}C_2 = 6\\) 通りが完全左右対称の並びとなる．従って，\n\\[\n\\frac{126 - 6}{2} + 6 = 66\\text{通り}\n\\]\n\n\n\n\n\nExercise 3.6 \nある野球チームの9人の選手の打順を決める．投手と二塁手は，７番，８番，９番のどれかにするとしたとき，９人の打順の決め方は何通りあるか？\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\n投手と２塁手以外の順番は \\(7!\\)\n投手と二塁手の順番の表し方は \\(2!\\)\n投手と二塁手が専有する打順の組み合わせは \\({}_3C_2 = 3!/2!\\)\n\n従って，\n\\[\n7! \\times 2! \\times \\frac{3!}{2!} = 7! \\times 3! = 5040 \\times 6 = 30240\n\\]\n\n\n\n\n\nExercise 3.7 \n4つのサイコロの出る目のくみあわせを求めよ． 例: \\((4, 1, 1, 1)\\) という組と \\((1, 4, 1, 1)\\) 組は出ている目の組み合わせが同じなので 同一の組とみなす．\n\n\n\n\n\n\n\n\nSolution - 組み合わせ\n\n\n\n\n\n\n4つすべて同じ目の場合: \\(6\\text{通り}\\)\n3つが同じ目の場合: \\({}_6C_2 \\times 2 = 30\\text{通り}\\)\n2つ, 2つが同じ目の場合: \\({}_6C_2 = 15\\text{通り}\\)\n2つが同じ目，残り２つ異なる目の場合: \\({}_6C_3 \\times 3 = 60\\text{通り}\\)\nすべてが異なる場合: \\({}_6C_4 = 15\\text{通り}\\)\n\n従って，\\(126\\text{通り}\\)\n\n\n\n\n\n\n\n\n\nSolution - 重複組み合わせ\n\n\n\n\n\nサイコロの枠 1, 2, 3, 4, 5, 6に対して区別されない４つのボールを重複を許してアサインする問題と考えることができるので\n\\[\n{}_6H_4 = {}_{9}C_4 = 126\\text{通り}\n\\]\n\n\n\n\n\nExercise 3.8 \nサイコロを \\(n\\) 回なげるとき，その結果である標本点を \\((x_1, x_2, \\cdots, x_n)\\) であらわす． この標本の個数を求めよ．\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n重複を許して \\(\\{1, 2, 3, 4, 5, 6\\}\\) からn個選んで順列を作る問題とみなせるので \\(2^n\\text{通り}\\)\n\n\n\n\n\nExercise 3.9 \nサイコロを \\(n\\) 回なげるとき，\\(i \\in \\{1, 2, 3, 4, 5, 6\\}\\) の目が \\(r_i\\) 回出たとする．各面の出る確率が \\(p_i\\) で表されるときの 確率関数 \\(P( \\mathbf{r})\\) を求めよ．ただし，\n\\[\n\\begin{align*}\n\\sum_{i=1}^6 p_i &= 1\\\\\n\\sum_{i=1}^6 r_i &= n\n\\end{align*}\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\nP( \\mathbf{r}) = \\frac{n!}{r_1!r_2!r_3!r_4!r_5!r_6!}p_1^{r_1}p_2^{r_2}p_3^{r_3}p_4^{r_4}p_5^{r_5}p_6^{r_6}\n\\]\n\n\n\n\n\nExercise 3.10 \n10円硬貨６枚，100円硬貨４枚，500円硬貨２枚から全部，または一部（どれも使わないはなし）を使って支払える金額は何通りあるか？\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n7\\times 5 \\times 3 - 1 = 104\n\\]\n\n\n\n\n\nExercise 3.11 支払金額の数と多項式 \n10円硬貨６枚，100円硬貨６枚，500円硬貨２枚から全部，または一部（どれも使わないはなし）を使って支払える金額は何通りあるか？\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nこの問題は\n\\[\n\\begin{align*}\nf(x)\\equiv &(1 + x^{10} + x^{20} + x^{30} + x^{40} + x^{50} + x^{60})\\\\\n&\\times (1 + x^{100} + x^{200} + x^{300} + x^{400} + x^{500} + x^{600})\\\\\n&\\times (1 + x^{500} + x^{1000})\n\\end{align*}\n\\]\nと式をおいたときに，\\(x\\)の項の数と置き換えて考えることができます．従って，\n\\[\n\\begin{align*}\nf(x) =& (1 + x^{10} + x^{20} + x^{30} + x^{40} + x^{50} + x^{60})\\\\\n      &\\times (1 + x^{100} + x^{200} + x^{300} + x^{400} + 2x^{500} + 2x^{600}\\\\\n      & + x^{700} + x^{800} + x^{900} + 2x^{1000} + 2x^{1100} + x^{1200} + x^{1300} + x^{1400} + x^{1500} + x^{1600})\n\\end{align*}\n\\]\n従って，\\(7 \\times 15 - 1 = 84\\text{通り}\\)\n ▶  Rでの検算\n\nx &lt;- c(10, 100, 500)\ny &lt;- list(\n    coin1 = seq(0, 4),\n    coin2 = seq(0, 6),\n    coin3 = seq(0, 2)\n)\n\n# Perform a product join using expand.grid()\nproduct_join_result &lt;- expand.grid(y)\n\n# Convert the data frame to an array\nproduct_join_array &lt;- as.matrix(product_join_result)\n\n# Get the matrix product\nres &lt;- product_join_array %*% x\nlength(unique(res))\n\n[1] 85\n\n\n\n\n\n\n\nExercise 3.12 \nAABCCDEという７文字をすべて用いて並べるとき，以下の場合の数を求めよ\n\n異なる順列の総数\nAAという並び方と，CCという並び方を，ともに含む順列の総数\nACまたはCAという並び方を少なくとも１つ含む順列の総数\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n ▶  1. 異なる順列の総数\n\\[\n\\frac{7!}{2!2!} = 1260\\text{通り}\n\\]\n ▶  2. AAという並び方と，CCという並び方を，ともに含む順列の総数\n\\[\n5! =  120\\text{通り}\n\\]\n ▶  3. ACまたはCAという並び方を少なくとも１つ含む順列の総数\nまずAABDEという文字列の並び方の総数は\n\\[\n\\frac{5!}{2!} = 60\\text{通り}\n\\]\nこのうち，以下の場合分けができる\n\nA同士が隣り合う場合 → Cが入れる枠は ○BAAD○E○ の○の位置数なので３通り\nA同士が隣り合わない場合 → Cが入れる枠は ABAD○E○ の○の位置数なので2通り\n\n\\[\n\\begin{align*}\n\\text{A同士が隣り合う場合の数} &= 4! = 24\\\\\n\\text{A同士が隣り合わない場合の数} &= 60 - 24 = 36\n\\end{align*}\n\\]\n更に，○の位置へのCの割り当て方は区別できないボールを区別できるツボへ空を許容して割り当てる問題と同一視できるので\n\\[\n\\begin{align*}\n\\text{A同士が隣り合う場合のCの組み合わせ} &= {}_3H_2 = 6\\\\\n\\text{A同士が隣り合わない場合のCの組み合わせ} &=  {}_2H_2 = 3\n\\end{align*}\n\\]\n従って，AとCが隣り合わない場合の数は\n\\[\n6 \\times 24 + 3 \\times 36 = 252\n\\]\n「ACまたはCAという並び方を少なくとも１つ含む順列の総数」は全事象から「AとCが隣り合わない場合の数」を引けば良いので\n\\[\n1260 - 252 = 1008\\text{通り}\n\\]",
    "crumbs": [
      "確率基礎",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>場合の数</span>"
    ]
  },
  {
    "objectID": "posts/statistics101/combination_permutation.html#二項係数",
    "href": "posts/statistics101/combination_permutation.html#二項係数",
    "title": "3  場合の数",
    "section": "二項係数",
    "text": "二項係数\n\n\nExercise 3.13 \n\\[\n\\bigg(x^3 - \\frac{3}{x}\\bigg)^6\n\\]\nの \\(x^2\\) の係数を求めよ\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\(x^2\\) の係数は\n\\[\n\\begin{align*}\n\\frac{6!}{p!q!} (-3)^q\\  \\ \\text{s.t. }& 3p - q = 2\\\\\n& p + q = 6\\\\\n& p \\geq 0, q \\geq 0\n\\end{align*}\n\\]\n上記の制約を満たす \\((p, q) = (2, 4)\\) なので\n\\[\n\\frac{6!}{2!4!}(-3)^4 = 15 \\times 81 = 1215\n\\]\n\n\n\n\n\nExercise 3.14 パスカルの三角形 \n以下の等式を証明せよ\n\\[\n{}_nC_r = {}_{n-1}C_{r} + {}_{n-1}C_{r-1}\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n\\begin{align*}\n{}_{n-1}C_{r} + {}_{n-1}C_{r-1} &= \\frac{(n-1)!}{r!(n-1-r)!} + \\frac{(n-1)!}{(r-1)!(n-r)!}\\\\\n                                &= \\frac{(n-1)!}{r!(n-r)!}((n-r) - r)\\\\\n                                &= \\frac{n!}{r!(n-r)!} = {}_nC_r\n\\end{align*}\n\\]\n\n📘 REMARKS \n\nパスカルの三角形で「上の2つの数字の和が下と等しい」という性質を表している\n組み合わせの文脈では，n 個のものから r 個のものを選ぶ組み合わせの集合は，Aを除いたn-1個からr個選ぶ集合 + Aを用いて残りのn-1個から r-1個選ぶ集合の和集合と等しい\n\n\n\n\n\n\n\nExercise 3.15 \n以下の等式を証明せよ\n\\[\n\\begin{align*}\n&\\sum_{i=0}^n {}_nC_i = 2^n \\tag{a}\\\\\n&\\sum_{i=0}^n (-1)^i{}_nC_i = 0 \\tag{b}\n\\end{align*}\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n ▶  (a)\n\\[\n\\begin{align*}\n(1 + 1)^n = \\sum_{i=0}^n {}_nC_i = 2^n\n\\end{align*}\n\\]\n ▶  (b)\n\\[\n(1 - 1)^n = \\sum_{i=0}^n (-1)^i{}_nC_i = 0\n\\]\n\n\n\n\n\nExercise 3.16 \n以下の等式を証明せよ\n\\[\n{}_nC_1 + 2 {}_nC_2 + \\cdots + r {}_nC_r + \\cdots + n{}_nC_n = 2^{n-1}n\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n\\begin{align*}\n2^{n-1}n &= (1 + 1)^{n-1}n\\\\\n         &= n\\sum_{i=0}^{n-1}{}_{n-1}C_i\\\\\n         &=\\sum_{i=0}^{n-1}\\frac{n!}{i!(n-1-i)!}\\\\\n         &=\\sum_{i=0}^{n-1}\\frac{n!}{i!(n-i)!}(n-i)\\\\\n         &= \\sum_{i=0}^{n}\\frac{n!}{i!(n-i)!}(n-i)\\\\\n         &= \\sum_{j=0}^{n}\\frac{n!}{j!(n-j)!}j\\\\\n         &= {}_nC_1 + 2 {}_nC_2 + \\cdots + r {}_nC_r + \\cdots + n{}_nC_n\n\\end{align*}\n\\]\n\n\n\n\n\n\n\n\n\nSolution - 微分を用いた別解\n\n\n\n\n\n\\((1 + x)^n\\) を \\(x\\) について微分して以下のような式を得ます\n\\[\n\\begin{align*}\nn(1 + x)^{n-1} = \\sum_{i=1}^n {}_nC_{i} i x^{i-1}\n\\end{align*}\n\\]\nこの式に対して \\(x=0\\) を代入すると\n\\[\n2^{n-1} n = \\sum_{i=1}^n {}_nC_{i} i\n\\]\n\n\n\n\n\nExercise 3.17 \n以下の等式を証明せよ\n\\[\n{}_nC_0 + \\frac{1}{2} {}_nC_1 + \\cdots + \\frac{1}{r+1} {}_nC_r + \\cdots + \\frac{1}{n+1}{}_nC_n = \\frac{2^{n+1}-1}{n+1}\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n\\begin{align*}\n\\frac{2^{n+1}-1}{n+1} &= \\frac{(1 + 1)^{n+1} - 1}{n + 1}\\\\\n                      &= \\frac{1}{n+1}\\sum_{i=0}^{n+1}\\frac{(n+1)!}{i!(n+1-i)!} - \\frac{1}{n+1}\\\\\n                      &= \\sum_{i=0}^{n}\\frac{n!}{i!(n+1-i)!} + \\frac{1}{n+1} - \\frac{1}{n+1}\\\\\n                      &= \\sum_{i=0}^{n}\\frac{n!}{i!(n-i)!}\\frac{1}{n-i + 1}\\\\\n                      &= \\sum_{j=0}^n \\frac{n!}{j!(n-j)!}\\frac{1}{j + 1}\n\\end{align*}\n\\]\n\n\n\n\n\n\n\n\n\nSolution - 積分を用いた別解\n\n\n\n\n\n厳密さは欠くが \\((1 + x)^n\\) を積分すると\n\\[\n\\frac{1}{n+1}(1 + x)^{n+1} + C = \\sum_{r=0}^n \\frac{1}{r+1}x^{r+1} + \\frac{1}{n+1} + C\n\\]\nを得るので，ここに \\(x=1\\) を代入すると\n\\[\n\\frac{2^{n+1} - 1}{n+1} = {}_nC_0 + \\frac{1}{2} {}_nC_1 + \\cdots + \\frac{1}{r+1} {}_nC_r + \\cdots + \\frac{1}{n+1}{}_nC_n\n\\]\n\n\n\n\n\nExercise 3.18 \n\\(k\\leq \\min(n,m)\\) としたとき，次の等式を証明せよ\n\\[\n\\sum_{i=0}^k {}_mC_i \\cdot {}_nC_{k-i} = {}_{m+n}C_{k}\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n(1+x)^{m+n} = (1 + x)^m(1 + x)^n\n\\]\nの両辺について，それぞれ \\(x^k\\) の係数 \\(p_k\\) を計算すると，まずLHSベースだと\n\\[\np_k = {}_{m+n}C_{k}\n\\]\nRHSベースで計算すると\n\\[\np_k = \\sum_{i=0}^k {}_mC_i \\cdot {}_nC_{k-i}\n\\]\n従って，\n\\[\n\\sum_{i=0}^k {}_mC_i \\cdot {}_nC_{k-i} = {}_{m+n}C_{k}\n\\]\n\n\n\n\n\nExercise 3.19 \nフェアなコインを２人が独立にｎ回ずつ投げるとき，表が同じ回数ずつ出る確率をもとめよ\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nプレーヤー \\(i\\in \\{1, 2\\}\\) が \\(n\\) 回トライして表を出す回数を \\(X_i\\) とすると，独立性より\n\\[\n\\Pr(X_1 = k, X_2 = k) = \\Pr(X_1 = k)\\Pr(X_2 = k)\n\\]\n\\[\n\\begin{align*}\n&\\Pr(X_i = k) = {}_nC_k \\bigg(\\frac{1}{2}\\bigg)^n\\\\\n&\\Rightarrow \\Pr(X_1 = k, X_2 = k) = {}_nC_k {}_nC_k \\bigg(\\frac{1}{2}\\bigg)^{2n}\n\\end{align*}\n\\]\n表が同じ回数ずつ出る確率を求めたいので, \\(\\Pr(\\text{n回トライしたとき表が同じ回数ずつ出る}) = p_n\\) とすると\n\\[\n\\begin{align*}\np_n &= \\sum_{k=0}^n {}_nC_k {}_nC_k \\bigg(\\frac{1}{2}\\bigg)^{2n}\\\\\n                             &= \\bigg(\\frac{1}{2}\\bigg)^{2n}\\sum_{k=0}^n {}_nC_k {}_nC_k\\\\\n                             &= \\bigg(\\frac{1}{2}\\bigg)^{2n} \\sum_{k=0}^n {}_nC_{k} {}_nC_{n-k}\\\\\n                             &= \\bigg(\\frac{1}{2}\\bigg)^{2n} {}_{2n}C_n\n\\end{align*}\n\\]\n\n📘 REMARKS \n\\(\\frac{1}{\\sqrt{1 + x}}\\) をマクローリン展開すると\n\\[\n\\begin{align*}\n\\frac{1}{\\sqrt{1 + x}} &= 1 + (-1)^1 \\frac{1}{2}x + (-1)^2\\frac{1}{2}\\frac{3}{2}\\frac{1}{2!}x^2 + (-1)^3\\frac{1}{2}\\frac{3}{2}\\frac{5}{2}\\frac{1}{3!}x^3 + \\cdots\\\\\n                       &= 1 + \\sum_{k=1}^\\infty (-1)^k\\frac{2k!}{2^k 2^k k! k!}x^k\\\\\n                       &= 1 + \\sum_{k=1}^\\infty (-1)^k\\frac{{}_{2k}C_k}{2^{2k}}x^k\\\\\n\\end{align*}\n\\]\nと 数列 \\(\\{p_n\\}\\) の情報を持っていることがわかる．このとき，\\(\\frac{1}{\\sqrt{1 + x}}\\) を \\(\\{p_n\\}\\) の確率母関数という．\n\n\n\n\n\n一般二項係数\n\n\nExercise 3.20 \n実数 \\(\\alpha\\), 正の整数 \\(n\\) に対して，次の等式を証明せよ\n\\[\n\\dbinom{-\\alpha}{r} = (-1)^r\\dbinom{\\alpha + r - 1}{r}\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n\\begin{align*}\n\\text{LHS} &= \\frac{(-\\alpha)(-\\alpha-1)\\cdots(-\\alpha-(r-1))}{r!}\\\\\n           &= (-1)^r\\frac{(\\alpha)(\\alpha+1)\\cdots(\\alpha+r-1)}{r!}\\\\\n           &= (-1)^r\\dbinom{\\alpha + r - 1}{r}\n\\end{align*}\n\\]\n\n\n\n\n\nExercise 3.21 \n実数 \\(\\alpha\\), 正の整数 \\(n\\) に対して，次の等式を証明せよ\n\\[\n\\dbinom{1/2}{n} = \\frac{(-1)^{n-1}}{2^{2n-1}n}\\dbinom{2n-2}{n-1}\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n\\begin{align*}\n\\text{LHS} &= \\frac{(\\frac{1}{2})(\\frac{1}{2}-1)\\cdots(\\frac{1}{2}-(n-1))}{n!}\\\\[6pt]\n           &= (-1)^{n-1}\\frac{\\frac{1}{2}\\frac{1}{2}\\frac{3}{2}\\cdots \\frac{2n-3}{2}}{n!}\\\\[6pt]\n           &= (-1)^{n-1}\\frac{(2n-2)!}{2^n 2^{n-1}(n-1)!n!}\\\\[6pt]\n           &= (-1)^{n-1}\\frac{(2n-2)!}{2^{2n-1}n(n-1)!(n-1)!}\\\\[6pt]\n           &= \\frac{(-1)^{n-1}}{2^{2n-1}n}\\dbinom{2n-2}{n-1}\n\\end{align*}\n\\]\n\n\n\n\n\nExercise 3.22 \n実数 \\(\\alpha\\), 正の整数 \\(n\\) に対して，次の等式を証明せよ\n\\[\n\\dbinom{-1/2}{n} = \\frac{(-1)^{n}}{2^{2n}n}\\dbinom{2n}{n}\n\\]\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\[\n\\begin{align*}\n\\text{LHS} &= \\frac{(-\\frac{1}{2})(-\\frac{1}{2}-1)\\cdots(-\\frac{1}{2}-(n-1))}{n!}\\\\[6pt]\n           &= (-1)^{n}\\frac{\\frac{1}{2}\\frac{3}{2}\\cdots \\frac{2n-1}{2}}{n!}\\\\[6pt]\n           &= (-1)^{n-1}\\frac{(2n)!}{2^n 2^{n}n!n!}\\\\[6pt]\n           &= \\frac{(-1)^{n}}{2^{2n}n}\\dbinom{2n}{n}\n\\end{align*}\n\\]",
    "crumbs": [
      "確率基礎",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>場合の数</span>"
    ]
  },
  {
    "objectID": "posts/statistics101/basic_probabilistic_model.html",
    "href": "posts/statistics101/basic_probabilistic_model.html",
    "title": "4  確率モデル - 基礎編",
    "section": "",
    "text": "確率モデル",
    "crumbs": [
      "確率基礎",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>確率モデル - 基礎編</span>"
    ]
  },
  {
    "objectID": "posts/statistics101/basic_probabilistic_model.html#確率モデル",
    "href": "posts/statistics101/basic_probabilistic_model.html#確率モデル",
    "title": "4  確率モデル - 基礎編",
    "section": "",
    "text": "Exercise 4.1 誕生日問題 \n４人が集まったとき，同じ誕生日の人が居る確率を求めよ．なお，１年は365日とし，各人の誕生日は独立に365日の離散型一様分布に従うとする．\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n全員が互いに誕生日が異なる確率 \\(P\\) は \\[\nP = \\frac{{}_{365}P_4}{365^4}\n\\]\n従って，少なくとも同じ誕生日の人が居る確率は \\(1 - P\\) で定義される． これをRで計算すると\n\nx &lt;- 365:362\nprob &lt;- prod(x) / (365 ** 4)\n1 - prob\n\n[1] 0.01635591\n\n\n\n\n\n\n\nExercise 4.2 誕生日問題 with R plot \n\\(n \\leq 100\\) 人のクラスのメンバー全員に誕生日を聞くとする，同じ誕生日の人が少なくとも一人以上居る確率をRでplotせよ． なお，なお，１年は365日とし，各人の誕生日は独立に365日の離散型一様分布に従うとする．\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\\(n\\) 人の集まりの中で少なくとも一人以上同じ誕生の人がいる確率は\n\\[\nP(n) = 1 - \\frac{{}_{365}P_n}{365^n}\n\\]\nこれをRでplotすると以下\n\n\nCode\nlibrary(ggplot2)\nsuppressPackageStartupMessages(library(plotly))\n\nx &lt;- seq(1, 100)\ny &lt;- 1 - sapply(x, function(i){prod(seq(365, 365-i+1))/365**i})\nfig &lt;- plot_ly(x = ~x, y = ~y, type = 'scatter', mode = 'lines') %&gt;%\n  layout(\n    title = \"クラス人数 vs 同じ誕生日の人が存在する確率\",\n    xaxis = list(title = \"クラス人数\"),\n    yaxis = list(title = \"P(n)\")\n  )\n\n# Display the plot\nfig\n\n\n\n\n\n\n\n\n\n\n\nExercise 4.3 \n表の出る確率 \\(p &gt; 0\\) のあるコインを独立に投げる試行を考える．裏が初めて出現するまで，表が奇数回続く確率が \\(1/3\\) 以下 であることが知られている．このとき，\\(p\\) の範囲を求めよ．\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n裏が初めて出るまで表が \\(r\\) 回続く確率を \\(P(r)\\) とすると，\\(P\\) は幾何分布に従うので\n\\[\nP(r) = p^r(1 - p)\n\\]\n裏が初めて出現するまで，表が奇数回続く確率が \\(1/3\\) 以下であるので\n\\[\n\\begin{align*}\n\\frac{1}{3} &\\geq \\sum_{i=0}^\\infty P(2r+1)\\\\\n            &= \\sum_{i=0}^\\infty p^{2i+1}(1-p)\\\\\n            &= \\frac{p}{1 - p^2}(1-p)\\\\\\\\\n            &= \\frac{p}{1 + p}\n\\end{align*}\n\\]\n従って，\n\\[\n0 &lt; p \\leq \\frac{1}{2}\n\\]",
    "crumbs": [
      "確率基礎",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>確率モデル - 基礎編</span>"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "5  Introduction",
    "section": "",
    "text": "This is a book created from markdown and executable code.\nSee Knuth (1984) for additional discussion of literate programming. sadasd\n\n\n\n\nKnuth, D. E. (1984), 「Literate Programming」, Comput. J., USA: Oxford University Press, Inc., 27, 97–111. https://doi.org/10.1093/comjnl/27.2.97.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "6  Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Summary</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Knuth, D. E. (1984), “Literate programming,” Comput.\nJ., USA: Oxford University Press, Inc., 27, 97–111. https://doi.org/10.1093/comjnl/27.2.97.",
    "crumbs": [
      "References"
    ]
  },
  {
    "objectID": "posts/statistics101/chapter_header.html",
    "href": "posts/statistics101/chapter_header.html",
    "title": "確率基礎",
    "section": "",
    "text": "標本空間と確率の公理\nラプラス流の古典的確率論は，\nという仮定のもとで，\\(\\Omega\\) の部分集合の全体 \\(\\wp(\\Omega)\\) に対する事象 \\(A\\in \\wp(\\Omega)\\) の確率\\(P(A)\\)を以下のように定義します\n\\[\nP(A) = \\frac{\\text{A の要素数}}{\\Omega\\text{の要素数}}\n\\]\n\\(\\Omega\\) を定義域，区間 \\([0, 1]\\) を値域とする写像 \\(P:\\Omega\\to[0, 1]\\) として確率関数を理解することができます．\n(P3)の有限加法性は\n\\[\n\\begin{align*}\n(A \\cap B) \\cup (A^c \\cap B) &= B\\\\\n(A \\cap B) \\cap (A^c \\cap B) &= \\emptyset\n\\end{align*}\n\\]\nより \\(\\Pr(B) = \\Pr(A \\cap B) + \\Pr(A^c \\cap B)\\) という式変形でよく使われます．",
    "crumbs": [
      "確率基礎"
    ]
  },
  {
    "objectID": "posts/statistics101/chapter_header.html#標本空間と確率の公理",
    "href": "posts/statistics101/chapter_header.html#標本空間と確率の公理",
    "title": "確率基礎",
    "section": "",
    "text": "Def: 標本空間 \n\n試行: 不確実性を伴う実験や調査\n標本点(sample point): 試行によって起こりうる個々の結果（=１点からなる事象）．集合表記した場合，根源事象と呼んだりもする\n標本空間(sample space): 標本点の全体からなる集合，一般的には\\(\\Omega\\)と表記される\n事象: \\(\\Omega\\)の部分集合\n\n\n\n\n標本空間\\(\\Omega\\)が有限個の点からなる集合\n標本点がすべて同程度に確からしい\n\n\n\n\nベン図的には \\(\\Omega\\) の面積を1と標準化して, 事象Aの面積を対応させる形でラプラス流古典的確率は定義される\n確率は事象に対して定義される\n\n\n📘 コルモゴロフの確率の公理 \n上記の古典的確率\\(P(A)\\)は常に以下の性質を満たしている．\n(P1) 任意の \\(A\\in \\wp(\\Omega)\\) に対して，\\(0 \\leq P(A) \\leq 1\\)  (P2) \\(P(\\Omega) = 1\\)  (P3) (有限加法性) \\(A_i \\in \\wp(\\Omega), i=1, \\cdots, n\\) としたとき \\(A_i \\cap A_j = \\emptyset (i\\neq j)\\) ならば\n\\[\nP\\bigg(\\bigcup^n_i A_i\\bigg)=\\sum_{i}^n P(A_i)\n\\]\n\n\n\n\n\n\nラプラス流確率論の問題点\n標本空間が無限集合となる場合，要素数の比という計算が不可能になってしまうという問題点をラプラス流確率論は抱えています． 集合の要素の個数の概念を無限集合についても一般化した「濃度」というものを用いたら解決できそうですが，実際は無理です．\n区間 \\(A = (0,1)\\) 上の一様分布に従う確率変数 \\(X\\) を考えます．\\(B = (0, 0.5)\\) としたとき，\\(X\\in B\\) となる確率は \\(\\Pr(X \\in (0, 0.5)) = 0.5\\) と区間の長さで確率測度を定義することで理解できますが，濃度となると 全単射となる \\(F;A\\to B\\) という写像を定義できるので，集合 \\(A\\) と \\(B\\) の濃度は等しい となってしまいます．そのため，現代では測度論に基づいて確率を定式化するのが主流です．",
    "crumbs": [
      "確率基礎"
    ]
  },
  {
    "objectID": "posts/statistics101/chapter_header.html#集合演算における分配法則とドモルガンの公式",
    "href": "posts/statistics101/chapter_header.html#集合演算における分配法則とドモルガンの公式",
    "title": "確率基礎",
    "section": "集合演算における分配法則とド・モルガンの公式",
    "text": "集合演算における分配法則とド・モルガンの公式\n\n 📘 集合演算における分配法則 \n\\[\n\\begin{align*}\nA \\cup (B\\cap C) &= (A\\cup B) \\cap (A\\cup C)\\\\\nA \\cap (B\\cup C) &= (A\\cap B) \\cup (A\\cap C)\n\\end{align*}\n\\]\n 📘 ド・モルガンの公式 \n\\[\n\\begin{align*}\n(A\\cup B)^c &= A^c \\cap B^c\\\\\n(A\\cap B)^c &= A^c \\cup B^c\n\\end{align*}\n\\]\n 📘 その他集合演算基本性質 \n\\[\n\\begin{align*}\nA\\cap A^c &= \\emptyset\\\\\nA\\cup A^c &= \\Omega\\\\\nA\\cup \\Omega &= \\Omega\\\\\nA\\cap \\Omega &= A\\\\\nA\\cap \\emptyset &= \\emptyset\n\\end{align*}\n\\]",
    "crumbs": [
      "確率基礎"
    ]
  },
  {
    "objectID": "posts/statistics101/chapter_header.html#条件付き確率と事象の独立性",
    "href": "posts/statistics101/chapter_header.html#条件付き確率と事象の独立性",
    "title": "確率基礎",
    "section": "条件付き確率と事象の独立性",
    "text": "条件付き確率と事象の独立性\n\nDef: 事象の独立 \nA,Bが確率事象で\n\\[\n\\Pr(A\\cap B) = \\Pr(A)\\Pr(B)\n\\]\nが成り立つとき，A, Bは互いに独立であるという．更に，一般に \\(A_1, \\cdots, A_n, \\cdots\\) が有限または加算個の確率事象系列で，その任意の 有限部分系列, \\(A_{i_1}, \\cdots, A_{i_k}\\) に対して\n\\[\n\\Pr(A_{i_1} \\cap \\cdots\\cap A_{i_k}) = \\Pr(A_{i_1}) \\cdots\\Pr(A_{i_k})\n\\]\nが成り立つとき，\\(A_1, \\cdots, A_n, \\cdots\\) は互いに独立であるという．\n\n\n\nDef: 条件付き確率 \n事象 \\(A, B\\) について，\\(\\Pr(A)\\neq 0\\) のとき\n\\[\n\\Pr(B\\vert A) = \\frac{\\Pr(A\\cap B)}{\\Pr(A)}\n\\]\nをAが起こったとき前提の下にBの起こる「条件付き確率」という．\n\n条件付き独立の定義より以下のこともわかる\n\\[\n\\begin{align*}\nA \\perp B &\\Leftrightarrow \\Pr(A\\cap B) = \\Pr(A)\\Pr(B)\\\\\n          &\\Leftrightarrow \\Pr(A\\cap B)/\\Pr(A) = \\Pr(B)\\\\\n          &\\Leftrightarrow \\Pr(B\\vert A) = \\Pr(B)\n\\end{align*}\n\\]\n\nExample 1 \n事象 A, Bが独立のとき，\\(\\Pr(B) = \\Pr(A\\cap B) + \\Pr(A^c\\cap B)\\)なので\n\\[\n\\begin{align*}\n&\\Pr(A\\cap B) = \\Pr(A)\\Pr(B)\\\\\n&\\Rightarrow \\Pr(A^c\\cap B) = (1  - \\Pr(A))\\Pr(B) = \\Pr(A^c)\\Pr(B)\n\\end{align*}\n\\]\n従って，事象 A, Bが独立のとき, \\(A^c \\perp B\\) が成立する．同様のロジックで, \\(A \\perp B^c, A^c\\perp B^c\\) も成立する．\n\n\nTheorem: 互いに独立 \nn個の事象の集まり \\(\\{A_1, \\cdots, A_n\\}\\) が互いに独立であるならば，\\(B_i = A_i\\) または \\(B_i = A_i^c\\) とおいて 得られる \\(k \\leq n\\) 個のあつまり \\(\\{B_1, B_2, \\cdots, B_k\\}\\) も互いに独立である．\n\nこの定理から，確率事象 \\(\\{A_1, \\cdots, A_n\\}\\) が互いに独立で，\\(\\Pr(A_i) = p_i\\) のとき，\n\\[\n\\Pr(A_1 \\cup \\cdots \\cup A_n) = 1 - (1 - p_1)(1 - p_2)\\cdots(1 - p_n)\n\\]\nが成立することがわかる．ド・モルガンの公式と独立性より\n\\[\n\\begin{align*}\n\\Pr(A_1 \\cup \\cdots \\cup A_n) &= 1 - \\Pr((A_1 \\cup \\cdots \\cup A_n))^c\\\\\n                              &= 1 - \\Pr(A_1^c \\cap \\cdots \\cap A_n^c)\\\\\n                              &= 1 - \\Pr(A_1^c)\\cdots\\Pr(A_n^c)\\\\\n                              &= 1 - (1 - p_1)(1 - p_2)\\cdots(1 - p_n)\n\\end{align*}\n\\]\nが成立するため．\n\nExample 2 \nn台のサーバーで動くシステムがある．このシステムは，n台すべてのサーバーが故障したときのみ停止する． それぞれのサーバーは独立に作動し，故障の確率は10%である．99%以上の可能性でシステムが停止とならないためには， 最低何台のサーバーが必要かを考えてみる．\n\\(A_i = \\{\\text{サーバー i が稼働している}\\}\\) と確率事象を定義すると，\\(\\Pr(A^c) = 0.1\\). つまり，\n\\[\n\\begin{align*}\n\\Pr(\\text{システムが稼働}) &= \\Pr(A_1 \\cup A_2 \\cup \\cdots \\cup A_n)\\\\\n                        &= 1 - \\Pr((A_1 \\cup A_2 \\cup \\cdots \\cup A_n)^c)\\\\\n                        &= 1 - \\Pr(A_1^c \\cap A_2^C \\cap \\cdots \\cap A_n^c)\\\\\n                        &= 1 - 0.1^n \\geq 0.99\n\\end{align*}\n\\]\n従って，\\(0.01 \\geq 0.1^n \\Rightarrow n\\geq 2\\).\n\n\n 📘 全確率の公式 \n確率事象 \\(A_1, A_2, \\cdots\\) に対し，\n\n\\(A_i\\cap A_j = \\emptyset \\ \\  (i\\neq j)\\)\n\\(\\Pr(A_i) &gt;0 \\ \\  \\forall i\\)\n\\(\\bigcup_i A_i = \\Omega\\)\n\nならば任意の確率事象 \\(B\\) について，\n\\[\nB = (A_1\\cap B) \\cup (A_2\\cap B) \\cup \\cdots\n\\]\nまた，各 \\((A_i\\cap B) \\cap (A_j\\cap B) = \\emptyset\\) が成立するので\n\\[\n\\Pr(B) = \\Pr(A_1\\cap B) + \\Pr(A_2\\cap B) \\cup \\cdots\n\\]\n従って，\n\\[\n\\Pr(B) = \\Pr(B\\vert A_1)\\Pr(A_1) + \\Pr(B\\vert A_2)\\Pr(A_2) + \\cdots\n\\]\nが成立する．\n\n\n\nDef: ベイズの定理 \n確率事象 \\(A_1, A_2, \\cdots\\) に対し，\n\n\\(A_i\\cap A_j = \\emptyset \\ \\ (i\\neq j)\\)\n\\(\\Pr(A_i) &gt;0 \\ \\  \\forall i\\)\n\\(\\bigcup_i A_i = \\Omega\\)\n\nならば任意の確率事象 \\(B\\) について，\\(\\Pr(B) &gt; 0\\) のときには \\(B\\) を与えたときの \\(A_j\\) の条件付き確率は\n\\[\n\\Pr(A_j\\vert B) = \\frac{\\Pr(B \\vert A_j)\\Pr(A_j)}{\\sum_{i=1}\\Pr(B \\vert A_i)\\Pr(A_i)}\n\\]\nと表される．とくに \\(\\Pr(A_j)\\) を事前確率, \\(\\Pr(A_j\\vert B)\\) を事後確率と呼ぶ．",
    "crumbs": [
      "確率基礎"
    ]
  },
  {
    "objectID": "posts/statistics101/chapter_header.html#組み合わせ",
    "href": "posts/statistics101/chapter_header.html#組み合わせ",
    "title": "確率基礎",
    "section": "組み合わせ",
    "text": "組み合わせ\n\n📘 マルチクラスの組み合わせ \nn個のものがc個のクラスに分けられていて，各クラスの個数を \\(n_i\\) と表すとする．このときの組み合わせ個数は\n\\[\n\\frac{n!}{n_1!n_2!\\cdots n_c!} \\ \\ (n_1 + n_2 + \\cdots + n_c = n)\n\\]\nと表せる．\n\n\nExample 3 \nn個の要素を\\(C_1, C_2, C_3\\)の３つのクラスに分けることを考える．\\(C_1\\) の個数を \\(n_1\\), \\(C_2\\) の個数を \\(n_2\\), \\(C_3\\) の個数を \\(n_3 = n-n_1-n_2\\)としたとき，\n\\[\n\\begin{align*}\n{}_nC_{n_1} \\times {}_{n-n_1}C_{n_2} &= \\frac{n!}{(n-n_1)!n_1!}\\frac{(n-n_1)!}{n_2!(n-n_1-n_2)!}\\\\\n                                     &=\\frac{n!}{n_1!n_2!n_3!}\n\\end{align*}\n\\]\nとなりマルチクラスの組み合わせの式と一致することがわかる．\n\n\n📘 重複組み合わせ \nn個のツボに，空ツボを許容して区別できない r 個のボールをアサインする問題を考えるとき，その組み合わせの個数は\n\\[\n{}_nH_r = {}_{n+r-1}C_r\n\\]\n\n重複組み合わせは次のような考えでも理解できる，例として，a, b, cの３つの文字から５個取り出す組み合わせの問題を考えるとする． このとき，\n\n○○|○○○| → aが2個, bが3個, cが0個\n○|○|○○○ → aが1個, bが1個, cが3個\n\nと考えてみると，○５個と|２個を一列に並べる問題と同一視できることがわかる．従って，\n\\[\n{}_3H_5 = \\frac{7!}{5!2!} = {}_{7}C_2\n\\]\n\nExample 4 \n黒と白の２種類のまんじゅうから３個のまんじゅうを買う問題を考える．このとき，組み合わせに個数は\n\\[\n{}_2H_3 = {}_4C_3 = 4\n\\]\nとなるが，実際に買い方として \\((3, 0), (2, 1), (1, 2), (3, 0)\\) が考えられるので正しいことがわかる．\n\n\n📘 写像を用いた重複組み合わせと組み合わせの対応 \n集合 \\(A = \\{1, 2, 3, \\cdots, r\\}, B = \\{1, 2, 3, \\cdots, n\\}, C = \\{1, 2, 3, \\cdots, n + r - 1\\}\\) であるとき， 写像 \\(f: A\\to B\\) に対して，\n\\[\nF(k) = f(k) + (k - 1)\n\\]\nという写像 \\(F: A\\to C\\) を考える．このとき，\n\n\\(f\\) が広義単調増加写像なら \\(F:A\\to C\\) は狭義単調増加写像となる\n\\(F\\) が狭義単調増加写像なら \\(f\\) は広義単調増加写像になる\n\n従って，広義単調増加写像に限定した \\(f\\) の個数と 狭義単調増加写像に限定した \\(F\\) の個数は等しくなるので\n\\[\n{}_nH_r = _{n+r-1}C_r\n\\]\nという関係性がわかる．\n\n\n\nDef: 一般化二項係数 \n\\(\\alpha \\in \\mathbb R, r \\in \\mathbb Z_+\\) としたとき，\n\\[\n\\dbinom{\\alpha}{r} = \\frac{\\Gamma(\\alpha + 1 )}{\\Gamma(a - r + 1)\\Gamma(r + 1)} = \\frac{\\alpha(\\alpha - 1)\\cdots (\\alpha - (r-1))}{r!}\n\\]\nこれを一般化二項係数と呼ぶ",
    "crumbs": [
      "確率基礎"
    ]
  }
]